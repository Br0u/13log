<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Photos - 13log</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      /* ÈªòËÆ§‰∏∫lightÊ®°Âºè */
      :root {
        --bg-color: #fafafa;
        --text-color: #1d1d1d;
        --btn-hover: rgba(0, 0, 0, 0.1);
      }

      /* darkÊ®°ÂºèË¶ÜÁõñ */
      body.dark {
        --bg-color: #000;
        --text-color: white;
        --btn-hover: rgba(255, 255, 255, 0.1);
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        background: var(--bg-color);
        color: var(--text-color);
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background-color 0.3s ease, color 0.3s ease;
      }

      .gallery-container {
        position: relative;
        padding: 8px;
      }

      #flip-gallery {
        position: relative;
        width: 300px;
        height: 500px;
        text-align: center;
        perspective: 1000px;
      }

      @media (min-width: 600px) {
        #flip-gallery {
          width: 360px;
          height: 600px;
        }
      }

      @media (min-width: 768px) {
        #flip-gallery {
          width: 400px;
          height: 640px;
        }
      }

      #flip-gallery::after {
        content: "";
        position: absolute;
        background-color: black;
        width: 100%;
        height: 4px;
        top: 50%;
        left: 0;
        transform: translateY(-50%);
      }

      #flip-gallery > * {
        position: absolute;
        width: 100%;
        height: 50%;
        overflow: hidden;
        background-size: cover;
        background-repeat: no-repeat;
        background-position: center;
      }

      .top,
      .overlay-top {
        top: 0;
        transform-origin: bottom;
        background-position: top;
      }

      .bottom,
      .overlay-bottom {
        bottom: 0;
        transform-origin: top;
        background-position: bottom;
      }

      .navigation {
        position: absolute;
        top: 100%;
        right: 0;
        margin-top: 8px;
        display: flex;
        gap: 8px;
      }

      .nav-button {
        background: none;
        border: none;
        color: var(--text-color);
        opacity: 0.75;
        cursor: pointer;
        transition: all 0.3s ease;
        padding: 4px;
        width: 28px;
        height: 28px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .nav-button:hover {
        opacity: 1;
        transform: scale(1.25);
      }

      /* ËøîÂõûÊåâÈíÆ */
      .back-btn {
        position: absolute;
        top: 20px;
        right: 20px;
        background: transparent;
        border: none;
        color: var(--text-color);
        padding: 8px 16px;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
        font-size: 1.2rem;
        z-index: 20;
        opacity: 0.7;
      }

      .back-btn:hover {
        background: var(--btn-hover);
        opacity: 1;
        transform: translateY(-2px);
      }

    </style>
  </head>
  <body>
    <!-- ËøîÂõûÊåâÈíÆ -->
    <a href="/" class="back-btn">‚Üê</a>

    <div class="gallery-container">
      <!-- ÁøªËΩ¨ÁîªÂªä -->
      <div id="flip-gallery" data-title="">
        <div class="top unite"></div>
        <div class="bottom unite"></div>
        <div class="overlay-top unite"></div>
        <div class="overlay-bottom unite"></div>
      </div>

      <!-- ÂØºËà™ÊåâÈíÆ -->
      <div class="navigation">
        <button type="button" class="nav-button" id="prevBtn" title="Previous">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <polyline points="15,18 9,12 15,6"></polyline>
          </svg>
        </button>
        <button type="button" class="nav-button" id="nextBtn" title="Next">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <polyline points="9,18 15,12 9,6"></polyline>
          </svg>
        </button>
      </div>
    </div>

    <script>
      // ÁÖßÁâáÊï∞ÊçÆ - ‰ΩøÁî®‰Ω†ÁöÑ‰∏™‰∫∫‰ΩúÂìÅ
      const images = [
        // JPGÊ†ºÂºèÁÖßÁâáÔºà‰ºòÂÖà‰ΩøÁî®ÔºåÂÖºÂÆπÊÄßÂ•ΩÔºâ
        {
          title: "ÊëÑÂΩ±‰ΩúÂìÅ 01",
          url: "/images/gallery/05051dcb0t816a84ff98745e8c52828a.jpg",
        },
        {
          title: "ÊëÑÂΩ±‰ΩúÂìÅ 02",
          url: "/images/gallery/1b0b6ebfekd712a8c9ddb3a919f6e51b.jpg",
        },
        {
          title: "ÊëÑÂΩ±‰ΩúÂìÅ 03",
          url: "/images/gallery/c310c2b15s058b7dad526c25892e071d.jpg",
        },
        {
          title: "ÊëÑÂΩ±‰ΩúÂìÅ 04",
          url: "/images/gallery/e432e79a6nb6db538d9df8e8daf47bcd.jpg",
        },
        { title: "ËÉ∂ÁâáËÆ∞ÂΩï 01", url: "/images/gallery/R0001640.jpg" },
        { title: "ËÉ∂ÁâáËÆ∞ÂΩï 02", url: "/images/gallery/R0002247.jpg" },
        { title: "ËÉ∂ÁâáËÆ∞ÂΩï 03", url: "/images/gallery/R0003289.jpg" },

        // ÁîüÊ¥ªÁû¨Èó¥ÁÖßÁâáÔºàÂ∑≤ËΩ¨Êç¢‰∏∫JPGÊ†ºÂºèÔºâ
        { title: "ÁîüÊ¥ªÁû¨Èó¥ 01", url: "/images/gallery/IMG_1947.jpg" },
        { title: "ÁîüÊ¥ªÁû¨Èó¥ 02", url: "/images/gallery/IMG_3058.jpg" },
        { title: "ÁîüÊ¥ªÁû¨Èó¥ 03", url: "/images/gallery/IMG_3545.jpg" },
        { title: "ÁîüÊ¥ªÁû¨Èó¥ 04", url: "/images/gallery/IMG_3658.jpg" },
        { title: "ÁîüÊ¥ªÁû¨Èó¥ 05", url: "/images/gallery/IMG_4023.jpg" },
        { title: "ÁîüÊ¥ªÁû¨Èó¥ 06", url: "/images/gallery/IMG_4256.jpg" },
        { title: "ÁîüÊ¥ªÁû¨Èó¥ 07", url: "/images/gallery/IMG_4290.jpg" },
        { title: "ÁîüÊ¥ªÁû¨Èó¥ 08", url: "/images/gallery/IMG_7282.jpg" },
        { title: "ÁîüÊ¥ªÁû¨Èó¥ 09", url: "/images/gallery/IMG_7285.jpg" },
        { title: "ÁîüÊ¥ªÁû¨Èó¥ 10", url: "/images/gallery/IMG_8441.jpg" },
        { title: "ÁîüÊ¥ªÁû¨Èó¥ 11", url: "/images/gallery/IMG_8682.jpg" },
        { title: "ÁîüÊ¥ªÁû¨Èó¥ 12", url: "/images/gallery/IMG_8790.jpg" },
        { title: "ÁîüÊ¥ªÁû¨Èó¥ 13", url: "/images/gallery/IMG_8812.jpg" },
        { title: "ÁîüÊ¥ªÁû¨Èó¥ 14", url: "/images/gallery/IMG_8819.jpg" },
        { title: "ÁîüÊ¥ªÁû¨Èó¥ 15", url: "/images/gallery/IMG_9132.jpg" },
      ];

      // ÁÖßÁâáÁîªÂªäÂ∑≤‰ºòÂåñÔºöÊâÄÊúâÂõæÁâáÈÉΩ‰ΩøÁî®JPGÊ†ºÂºèÔºåÁ°Æ‰øùÊúÄ‰Ω≥ÂÖºÂÆπÊÄß
      console.log("üì∏ ÁÖßÁâáÁîªÂªäÂä†ËΩΩÂÆåÊàê - ÂÖ± " + images.length + " Âº†ÁÖßÁâá");

      // ÈÖçÁΩÆ
      const FLIP_SPEED = 750;
      const flipTiming = { duration: FLIP_SPEED, iterations: 1 };

      // ÁøªËΩ¨Âä®ÁîªÂÖ≥ÈîÆÂ∏ß
      const flipAnimationTop = [
        { transform: "rotateX(0)" },
        { transform: "rotateX(-90deg)" },
        { transform: "rotateX(-90deg)" },
      ];
      const flipAnimationBottom = [
        { transform: "rotateX(90deg)" },
        { transform: "rotateX(90deg)" },
        { transform: "rotateX(0)" },
      ];

      // ÂèçÂêëÁøªËΩ¨Âä®ÁîªÂÖ≥ÈîÆÂ∏ß
      const flipAnimationTopReverse = [
        { transform: "rotateX(-90deg)" },
        { transform: "rotateX(-90deg)" },
        { transform: "rotateX(0)" },
      ];
      const flipAnimationBottomReverse = [
        { transform: "rotateX(0)" },
        { transform: "rotateX(90deg)" },
        { transform: "rotateX(90deg)" },
      ];

      // ÂÖ®Â±ÄÂèòÈáè
      let currentIndex = 0;
      let container, uniteElements;

      // ÂàùÂßãÂåñ
      function init() {
        container = document.getElementById("flip-gallery");
        uniteElements = container.querySelectorAll(".unite");

        defineFirstImg();
        setupEventListeners();
      }

      // ËÆæÁΩÆÁ¨¨‰∏ÄÂº†ÂõæÁâá
      function defineFirstImg() {
        uniteElements.forEach(setActiveImage);
      }

      // ËÆæÁΩÆÊ¥ªÂä®ÂõæÁâáÔºàÁÆÄÂåñÁâàÊú¨ - ÊâÄÊúâÂõæÁâáÈÉΩÊòØJPGÊ†ºÂºèÔºâ
      function setActiveImage(el) {
        const imageUrl = images[currentIndex].url;
        el.style.backgroundImage = `url('${imageUrl}')`;
      }

      // Êõ¥Êñ∞ÁîªÂªä
      function updateGallery(nextIndex, isReverse = false) {
        // Á°ÆÂÆöÂä®ÁîªÊñπÂêë
        const topAnim = isReverse ? flipAnimationTopReverse : flipAnimationTop;
        const bottomAnim = isReverse
          ? flipAnimationBottomReverse
          : flipAnimationBottom;

        // ÊâßË°åÁøªËΩ¨Âä®Áîª
        container.querySelector(".overlay-top").animate(topAnim, flipTiming);
        container
          .querySelector(".overlay-bottom")
          .animate(bottomAnim, flipTiming);

        // Êõ¥Êñ∞ÂõæÁâáÔºàÂ∏¶Âª∂Ëøü‰ª•‰øùÊåÅÂä®ÁîªËøûÁª≠ÊÄßÔºâ
        uniteElements.forEach((el, idx) => {
          const delay =
            (isReverse && idx !== 1 && idx !== 2) ||
            (!isReverse && (idx === 1 || idx === 2))
              ? FLIP_SPEED - 200
              : 0;

          setTimeout(() => setActiveImage(el), delay);
        });
      }

      // Êõ¥Êñ∞Á¥¢Âºï
      function updateIndex(increment) {
        const inc = Number(increment);
        const newIndex = (currentIndex + inc + images.length) % images.length;
        const isReverse = inc < 0;
        currentIndex = newIndex;
        updateGallery(newIndex, isReverse);
      }

      // ËÆæÁΩÆ‰∫ã‰ª∂ÁõëÂê¨Âô®
      function setupEventListeners() {
        document
          .getElementById("prevBtn")
          .addEventListener("click", () => updateIndex(-1));
        document
          .getElementById("nextBtn")
          .addEventListener("click", () => updateIndex(1));

        // ÈîÆÁõòÂØºËà™
        document.addEventListener("keydown", (e) => {
          if (e.key === "ArrowLeft") updateIndex(-1);
          if (e.key === "ArrowRight") updateIndex(1);
        });

        // Ëß¶Êë∏ÊâãÂäøÊîØÊåÅ
        let touchStartX = 0;
        container.addEventListener("touchstart", (e) => {
          touchStartX = e.touches[0].clientX;
        });

        container.addEventListener("touchend", (e) => {
          const touchEndX = e.changedTouches[0].clientX;
          const diff = touchStartX - touchEndX;

          if (Math.abs(diff) > 50) {
            // ÊúÄÂ∞èÊªëÂä®Ë∑ùÁ¶ª
            if (diff > 0) {
              updateIndex(1); // ÂêëÂ∑¶ÊªëÂä®Ôºå‰∏ã‰∏ÄÂº†
            } else {
              updateIndex(-1); // ÂêëÂè≥ÊªëÂä®Ôºå‰∏ä‰∏ÄÂº†
            }
          }
        });
      }

      // ÁÆÄÂçïÁöÑ‰∏ªÈ¢òË∑üÈöèÂäüËÉΩ
      function setupThemeFollow() {
        // Ê£ÄÊü•Êú¨Âú∞Â≠òÂÇ®ÁöÑ‰∏ªÈ¢òÂÅèÂ•ΩÔºà‰∏é‰∏ªÁ´ôÂêåÊ≠•Ôºâ
        const savedTheme = localStorage.getItem("pref-theme");
        const systemPrefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;

        // Â∫îÁî®‰∏ªÈ¢òÔºà‰∏éPaperModÈÄªËæë‰∏ÄËá¥Ôºâ
        if (savedTheme === "dark") {
          document.body.classList.add("dark");
        } else if (savedTheme === "light") {
          document.body.classList.remove("dark");
        } else if (systemPrefersDark) {
          document.body.classList.add("dark");
        }

        console.log("üì∏ PhotosÈ°µÈù¢‰∏ªÈ¢òÂ∑≤ÂêåÊ≠•:", savedTheme || (systemPrefersDark ? "dark" : "light"));
      }

      // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÂàùÂßãÂåñ
      document.addEventListener("DOMContentLoaded", () => {
        init();
        setupThemeFollow();
      });
    </script>
  </body>
</html>
